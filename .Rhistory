scale_x_continuous(limits=c(50, 100),
breaks=seq(50, 100, by=5),
labels=glue("{seq(50, 100, 5)}%")) +
scale_y_discrete(expand=c(0, 3.5)) +
labs(x=NULL, y=NULL,
title="코로나 백신 접종이 시작되면 접종을 받겠다",
caption="<i>15개 국가 16-74세 사이 18,526명에 대한 온라인 조사</i><br>출처: Ipsos") +
theme(plot.title.position = "plot",
plot.title = element_text(face="bold", margin= margin(b=20), size=20),
plot.caption = element_markdown(hjust=0, color="darkgray"),
plot.caption.position = "plot",
panel.background = element_blank(),
#plot.margin = unit(c(1,1,1,1), "cm"),
axis.ticks = element_blank(),
axis.text.x = element_text(color="darkgray"),
panel.grid.major.x = element_line(color="gray", size=0.1),
panel.grid.major.y = element_line(color="gray", size=0.1, linetype="dotted")) +
geom_richtext(x=71, y=17.5, label="<span style='color:#15607a'> 10월 </span>",
fill = NA, label.color = NA, size=3, show.legend = FALSE) +
geom_richtext(x=80, y=17.5, label="<span style='color:#727272'> 8월 </span>",
fill = NA, label.color = NA, size=3, show.legend = FALSE)
data %>%
pivot_longer(!country, names_to="month", values_to="agree") |>
filter(country != "Total") |>
group_by(country) %>%
mutate(increase = ifelse(agree == max(agree), TRUE, FALSE),
bump = ifelse(increase, agree + 2, agree - 2)) |>
ggplot(aes(x=agree, y=country, color=month)) +
geom_line(aes(group=country), size=1.75, color="#e6e6e6", show.legend = FALSE) +
geom_point(size=2, show.legend = FALSE) +
geom_text(aes(label=glue("{agree}%"), x=bump), show.legend=FALSE) +
scale_color_manual(name=NULL,
breaks=c("august", "october"),
values=c("#727272", "#15607a"),
labels=c("August", "October")) +
scale_x_continuous(limits=c(50, 100),
breaks=seq(50, 100, by=5),
labels=glue("{seq(50, 100, 5)}%")) +
scale_y_discrete(expand=c(0, 3.5)) +
labs(x=NULL, y=NULL,
title="코로나 백신 접종이 시작되면 접종을 받겠다",
caption="<i>15개 국가 16-74세 사이 18,526명에 대한 온라인 조사</i><br>출처: Ipsos") +
theme(plot.title.position = "plot",
plot.title = element_text(face="bold", margin= margin(b=20), size=20),
plot.caption = element_markdown(hjust=0, color="darkgray"),
plot.caption.position = "plot",
panel.background = element_blank(),
#plot.margin = unit(c(1,1,1,1), "cm"),
axis.ticks = element_blank(),
axis.text.x = element_text(color="darkgray"),
panel.grid.major.x = element_line(color="gray", size=0.1),
panel.grid.major.y = element_line(color="gray", size=0.1, linetype="dotted")) +
geom_richtext(x=64, y=16.5, label="<span style='color:#15607a'> 10월 </span>",
fill = NA, label.color = NA, size=3, show.legend = FALSE) +
geom_richtext(x=67, y=16.5, label="<span style='color:#727272'> 8월 </span>",
fill = NA, label.color = NA, size=3, show.legend = FALSE)
data %>%
pivot_longer(!country, names_to="month", values_to="agree") |>
filter(country != "Total") |>
group_by(country) %>%
mutate(increase = ifelse(agree == max(agree), TRUE, FALSE),
bump = ifelse(increase, agree + 2, agree - 2)) |>
ggplot(aes(x=agree, y=country, color=month)) +
geom_line(aes(group=country), size=1.75, color="#e6e6e6", show.legend = FALSE) +
geom_point(size=2, show.legend = FALSE) +
geom_text(aes(label=glue("{agree}%"), x=bump), show.legend=FALSE) +
scale_color_manual(name=NULL,
breaks=c("august", "october"),
values=c("#727272", "#15607a"),
labels=c("August", "October")) +
scale_x_continuous(limits=c(50, 100),
breaks=seq(50, 100, by=5),
labels=glue("{seq(50, 100, 5)}%")) +
scale_y_discrete(expand=c(0, 3.5)) +
labs(x=NULL, y=NULL,
title="코로나 백신 접종이 시작되면 접종을 받겠다",
caption="<i>15개 국가 16-74세 사이 18,526명에 대한 온라인 조사</i><br>출처: Ipsos") +
theme(plot.title.position = "plot",
plot.title = element_text(face="bold", margin= margin(b=20), size=20),
plot.caption = element_markdown(hjust=0, color="darkgray"),
plot.caption.position = "plot",
panel.background = element_blank(),
#plot.margin = unit(c(1,1,1,1), "cm"),
axis.ticks = element_blank(),
axis.text.x = element_text(color="darkgray"),
panel.grid.major.x = element_line(color="gray", size=0.1),
panel.grid.major.y = element_line(color="gray", size=0.1, linetype="dotted")) +
geom_richtext(x=62.5, y=16.5, label="<span style='color:#15607a'> 10월 </span>",
fill = NA, label.color = NA, size=3, show.legend = FALSE) +
geom_richtext(x=67.5, y=16.5, label="<span style='color:#727272'> 8월 </span>",
fill = NA, label.color = NA, size=3, show.legend = FALSE)
data %>%
pivot_longer(!country, names_to="month", values_to="agree") |>
filter(country != "Total") |>
group_by(country) %>%
mutate(increase = ifelse(agree == max(agree), TRUE, FALSE),
bump = ifelse(increase, agree + 2, agree - 2)) |>
ggplot(aes(x=agree, y=country, color=month)) +
geom_line(aes(group=country), size=1.75, color="#e6e6e6", show.legend = FALSE) +
geom_point(size=2, show.legend = FALSE) +
geom_text(aes(label=glue("{agree}%"), x=bump), show.legend=FALSE) +
scale_color_manual(name=NULL,
breaks=c("august", "october"),
values=c("#727272", "#15607a"),
labels=c("August", "October")) +
scale_x_continuous(limits=c(50, 100),
breaks=seq(50, 100, by=5),
labels=glue("{seq(50, 100, 5)}%")) +
scale_y_discrete(expand=c(0, 3.5)) +
labs(x=NULL, y=NULL,
title="코로나 백신 접종이 시작되면 접종을 받겠다",
caption="<i>15개 국가 16-74세 사이 18,526명에 대한 온라인 조사</i><br>출처: Ipsos") +
theme(plot.title.position = "plot",
plot.title = element_text(face="bold", margin= margin(b=20), size=20),
plot.caption = element_markdown(hjust=0, color="darkgray"),
plot.caption.position = "plot",
panel.background = element_blank(),
#plot.margin = unit(c(1,1,1,1), "cm"),
axis.ticks = element_blank(),
axis.text.x = element_text(color="darkgray"),
panel.grid.major.x = element_line(color="gray", size=0.1),
panel.grid.major.y = element_line(color="gray", size=0.1, linetype="dotted")) +
geom_richtext(x=63, y=16.2, label="<span style='color:#15607a'> 10월 </span>",
fill = NA, label.color = NA, size=3, show.legend = FALSE) +
geom_richtext(x=67.5, y=16.2, label="<span style='color:#727272'> 8월 </span>",
fill = NA, label.color = NA, size=3, show.legend = FALSE)
data %>%
pivot_longer(!country, names_to="month", values_to="agree") |>
filter(country != "Total") |>
group_by(country) %>%
mutate(increase = ifelse(agree == max(agree), TRUE, FALSE),
bump = ifelse(increase, agree + 2, agree - 2)) |>
ggplot(aes(x=agree, y=country, color=month)) +
geom_line(aes(group=country), size=1.75, color="#e6e6e6", show.legend = FALSE) +
geom_point(size=2, show.legend = FALSE) +
geom_text(aes(label=glue("{agree}%"), x=bump), show.legend=FALSE) +
scale_color_manual(name=NULL,
breaks=c("august", "october"),
values=c("#727272", "#15607a"),
labels=c("August", "October")) +
scale_x_continuous(limits=c(50, 100),
breaks=seq(50, 100, by=5),
labels=glue("{seq(50, 100, 5)}%")) +
scale_y_discrete(expand=c(0, 2.5)) +
labs(x=NULL, y=NULL,
title="코로나 백신 접종이 시작되면 접종을 받겠다",
caption="<i>15개 국가 16-74세 사이 18,526명에 대한 온라인 조사</i><br>출처: Ipsos") +
theme(plot.title.position = "plot",
plot.title = element_text(face="bold", margin= margin(b=20), size=20),
plot.caption = element_markdown(hjust=0, color="darkgray"),
plot.caption.position = "plot",
panel.background = element_blank(),
#plot.margin = unit(c(1,1,1,1), "cm"),
axis.ticks = element_blank(),
axis.text.x = element_text(color="darkgray"),
panel.grid.major.x = element_line(color="gray", size=0.1),
panel.grid.major.y = element_line(color="gray", size=0.1, linetype="dotted")) +
geom_richtext(x=63, y=16.2, label="<span style='color:#15607a'> 10월 </span>",
fill = NA, label.color = NA, size=3, show.legend = FALSE) +
geom_richtext(x=67.5, y=16.2, label="<span style='color:#727272'> 8월 </span>",
fill = NA, label.color = NA, size=3, show.legend = FALSE)
data %>%
pivot_longer(!country, names_to="month", values_to="agree") |>
filter(country != "Total") |>
group_by(country) %>%
mutate(increase = ifelse(agree == max(agree), TRUE, FALSE),
bump = ifelse(increase, agree + 2, agree - 2)) |>
ggplot(aes(x=agree, y=country, color=month)) +
geom_line(aes(group=country), size=1.75, color="#e6e6e6", show.legend = FALSE) +
geom_point(size=2, show.legend = FALSE) +
geom_text(aes(label=glue("{agree}%"), x=bump), show.legend=FALSE) +
scale_color_manual(name=NULL,
breaks=c("august", "october"),
values=c("#727272", "#15607a"),
labels=c("August", "October")) +
scale_x_continuous(limits=c(50, 100),
breaks=seq(50, 100, by=5),
labels=glue("{seq(50, 100, 5)}%")) +
scale_y_discrete(expand=c(0, 1.5)) +
labs(x=NULL, y=NULL,
title="코로나 백신 접종이 시작되면 접종을 받겠다",
caption="<i>15개 국가 16-74세 사이 18,526명에 대한 온라인 조사</i><br>출처: Ipsos") +
theme(plot.title.position = "plot",
plot.title = element_text(face="bold", margin= margin(b=20), size=20),
plot.caption = element_markdown(hjust=0, color="darkgray"),
plot.caption.position = "plot",
panel.background = element_blank(),
#plot.margin = unit(c(1,1,1,1), "cm"),
axis.ticks = element_blank(),
axis.text.x = element_text(color="darkgray"),
panel.grid.major.x = element_line(color="gray", size=0.1),
panel.grid.major.y = element_line(color="gray", size=0.1, linetype="dotted")) +
geom_richtext(x=63, y=16.2, label="<span style='color:#15607a'> 10월 </span>",
fill = NA, label.color = NA, size=3, show.legend = FALSE) +
geom_richtext(x=67.5, y=16.2, label="<span style='color:#727272'> 8월 </span>",
fill = NA, label.color = NA, size=3, show.legend = FALSE)
data %>%
pivot_longer(!country, names_to="month", values_to="agree") |>
filter(country != "Total") |>
group_by(country) %>%
# 그래프상 수치 표현을 위한 위치 지정
mutate(increase = ifelse(agree == max(agree), TRUE, FALSE),
bump = ifelse(increase, agree + 2, agree - 2)) |>
ggplot(aes(x=agree, y=country, color=month)) +
geom_line(aes(group=country), size=1.75, color="#e6e6e6", show.legend = FALSE) +
geom_point(size=2, show.legend = FALSE) +
# glue를 이용해 수치 뒤에 %를 삽입
geom_text(aes(label=glue("{agree}%"), x=bump), show.legend=FALSE) +
scale_color_manual(name=NULL,
breaks=c("august", "october"),
values=c("#727272", "#15607a")) +
#labels=c("August", "October")) +
scale_x_continuous(limits=c(50, 100),
breaks=seq(50, 100, by=5),
labels=glue("{seq(50, 100, 5)}%")) +
scale_y_discrete(expand=c(0, 1.5)) +
labs(x=NULL, y=NULL,
title="코로나 백신 접종이 시작되면 접종을 받겠다",
caption="<i>15개 국가 16-74세 사이 18,526명에 대한 온라인 조사</i><br>출처: Ipsos") +
theme(plot.title.position = "plot",
plot.title = element_text(face="bold", margin= margin(b=20), size=20),
plot.caption = element_markdown(hjust=0, color="darkgray"),
plot.caption.position = "plot",
panel.background = element_blank(),
#plot.margin = unit(c(1,1,1,1), "cm"),
axis.ticks = element_blank(),
axis.text.x = element_text(color="darkgray"),
panel.grid.major.x = element_line(color="gray", size=0.1),
panel.grid.major.y = element_line(color="gray", size=0.1, linetype="dotted")) +
geom_richtext(x=63, y=16.2, label="<span style='color:#15607a'> 10월 </span>",
fill = NA, label.color = NA, size=3, show.legend = FALSE) +
geom_richtext(x=67.5, y=16.2, label="<span style='color:#727272'> 8월 </span>",
fill = NA, label.color = NA, size=3, show.legend = FALSE)
View(data)
data$country
data %>%
# 나라 이름을 한글로 변환
mutate(country = case_when(country=="India"~"인도", country=="China"~"중국",
country=="South Korea"~"한국", country=="Barzil"~"브라질",
country=="Australia"~"호주", country=="United Kingdom"~"영국",
country=="Mexico"~"멕시코", country=="Canada"~"캐나다",
country=="Germany"~"독일", country=="Japan"~"일본",
country=="South Africa"~"남아공", country=="Italy"~"이탈리아",
country=="Spain"~"스페인", country=="United States"~"미국",
country=="France"~"프랑스")) |>
pivot_longer(!country, names_to="month", values_to="agree") |>
filter(country != "Total") |>
group_by(country) %>%
# 그래프상 수치 표현을 위한 위치 지정
mutate(increase = ifelse(agree == max(agree), TRUE, FALSE),
bump = ifelse(increase, agree + 2, agree - 2)) |>
ggplot(aes(x=agree, y=country, color=month)) +
geom_line(aes(group=country), size=1.75, color="#e6e6e6", show.legend = FALSE) +
geom_point(size=2, show.legend = FALSE) +
# glue를 이용해 수치 뒤에 %를 삽입
geom_text(aes(label=glue("{agree}%"), x=bump), show.legend=FALSE) +
scale_color_manual(name=NULL,
breaks=c("august", "october"),
values=c("#727272", "#15607a")) +
scale_x_continuous(limits=c(50, 100),
breaks=seq(50, 100, by=5),
labels=glue("{seq(50, 100, 5)}%")) +
# 세로 여백을 확보
scale_y_discrete(expand=c(0, 1.5)) +
labs(x=NULL, y=NULL,
title="코로나 백신 접종이 시작되면 접종을 받겠다",
caption="<i>15개 국가 16-74세 사이 18,526명에 대한 온라인 조사</i><br>출처: Ipsos") +
theme(plot.title.position = "plot",
plot.title = element_text(face="bold", margin= margin(b=20), size=20),
plot.caption = element_markdown(hjust=0, color="darkgray"),
plot.caption.position = "plot",
panel.background = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_text(color="darkgray"),
panel.grid.major.x = element_line(color="gray", size=0.1),
panel.grid.major.y = element_line(color="gray", size=0.1, linetype="dotted")) +
# 적절한 위치에 '8월', '10월' 표시시
geom_richtext(x=63, y=16.2, label="<span style='color:#15607a'> 10월 </span>",
fill = NA, label.color = NA, size=3, show.legend = FALSE) +
geom_richtext(x=67.5, y=16.2, label="<span style='color:#727272'> 8월 </span>",
fill = NA, label.color = NA, size=3, show.legend = FALSE)
data %>%
# 나라 이름을 한글로 변환
mutate(country = case_when(country=="India"~"인도", country=="China"~"중국",
country=="South Korea"~"한국", country=="Barzil"~"브라질",
country=="Australia"~"호주", country=="United Kingdom"~"영국",
country=="Mexico"~"멕시코", country=="Canada"~"캐나다",
country=="Germany"~"독일", country=="Japan"~"일본",
country=="South Africa"~"남아공", country=="Italy"~"이탈리아",
country=="Spain"~"스페인", country=="United States"~"미국",
country=="France"~"프랑스")) |>
pivot_longer(!country, names_to="month", values_to="agree") |>
filter(country != "Total") |>
group_by(country) %>%
# 그래프상 수치 표현을 위한 위치 지정
mutate(increase = ifelse(agree == max(agree), TRUE, FALSE),
bump = ifelse(increase, agree + 2, agree - 2)) |>
ggplot(aes(x=agree, y=country, color=month)) +
geom_line(aes(group=country), size=1.75, color="#e6e6e6", show.legend = FALSE) +
geom_point(size=2, show.legend = FALSE) +
# glue를 이용해 수치 뒤에 %를 삽입
geom_text(aes(label=glue("{agree}%"), x=bump), show.legend=FALSE) +
scale_color_manual(name=NULL,
breaks=c("august", "october"),
values=c("#727272", "#15607a")) +
scale_x_continuous(limits=c(50, 100),
breaks=seq(50, 100, by=5),
labels=glue("{seq(50, 100, 5)}%")) +
# 세로 여백을 확보
scale_y_discrete(expand=c(0, 1.5)) +
labs(x=NULL, y=NULL,
title="코로나 백신 접종이 시작되면 접종을 받겠다",
caption="<i>15개 국가 16-74세 사이 18,526명에 대한 온라인 조사</i><br>출처: Ipsos") +
theme(plot.title.position = "plot",
plot.title = element_text(face="bold", margin= margin(b=20), size=20),
plot.caption = element_markdown(hjust=0, color="darkgray"),
plot.caption.position = "plot",
panel.background = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_text(color="darkgray"),
panel.grid.major.x = element_line(color="gray", size=0.1),
panel.grid.major.y = element_line(color="gray", size=0.1, linetype="dotted")) +
# 적절한 위치에 '8월', '10월' 표시시
geom_richtext(x=63, y=14.2, label="<span style='color:#15607a'> 10월 </span>",
fill = NA, label.color = NA, size=3, show.legend = FALSE) +
geom_richtext(x=67.5, y=14.2, label="<span style='color:#727272'> 8월 </span>",
fill = NA, label.color = NA, size=3, show.legend = FALSE)
data %>%
# 나라 이름을 한글로 변환
mutate(country = case_when(country=="India"~"인도", country=="China"~"중국",
country=="South Korea"~"한국", country=="Barzil"~"브라질",
country=="Australia"~"호주", country=="United Kingdom"~"영국",
country=="Mexico"~"멕시코", country=="Canada"~"캐나다",
country=="Germany"~"독일", country=="Japan"~"일본",
country=="South Africa"~"남아공", country=="Italy"~"이탈리아",
country=="Spain"~"스페인", country=="United States"~"미국",
country=="France"~"프랑스")) |>
pivot_longer(!country, names_to="month", values_to="agree") |>
filter(country != "Total") |>
group_by(country) %>%
# 그래프상 수치 표현을 위한 위치 지정
mutate(increase = ifelse(agree == max(agree), TRUE, FALSE),
bump = ifelse(increase, agree + 2, agree - 2)) |>
ggplot(aes(x=agree, y=country, color=month)) +
geom_line(aes(group=country), size=1.75, color="#e6e6e6", show.legend = FALSE) +
geom_point(size=2, show.legend = FALSE) +
# glue를 이용해 수치 뒤에 %를 삽입
geom_text(aes(label=glue("{agree}%"), x=bump), show.legend=FALSE) +
scale_color_manual(name=NULL,
breaks=c("august", "october"),
values=c("#727272", "#15607a")) +
scale_x_continuous(limits=c(50, 100),
breaks=seq(50, 100, by=5),
labels=glue("{seq(50, 100, 5)}%")) +
# 세로 여백을 확보
scale_y_discrete(expand=c(0, 1.5)) +
labs(x=NULL, y=NULL,
title="코로나 백신 접종이 시작되면 접종을 받겠다",
caption="<i>15개 국가 16-74세 사이 18,526명에 대한 온라인 조사</i><br>출처: Ipsos") +
theme(plot.title.position = "plot",
plot.title = element_text(face="bold", margin= margin(b=20), size=20),
plot.caption = element_markdown(hjust=0, color="darkgray"),
plot.caption.position = "plot",
panel.background = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_text(color="darkgray"),
panel.grid.major.x = element_line(color="gray", size=0.1),
panel.grid.major.y = element_line(color="gray", size=0.1, linetype="dotted")) +
# 적절한 위치에 '8월', '10월' 표시시
geom_richtext(x=78, y=14.7, label="<span style='color:#15607a'> 10월 </span>",
fill = NA, label.color = NA, size=3, show.legend = FALSE) +
geom_richtext(x=89, y=14.7, label="<span style='color:#727272'> 8월 </span>",
fill = NA, label.color = NA, size=3, show.legend = FALSE)
data %>%
# 나라 이름을 한글로 변환
mutate(country = case_when(country=="India"~"인도", country=="China"~"중국",
country=="South Korea"~"한국", country=="Barzil"~"브라질",
country=="Australia"~"호주", country=="United Kingdom"~"영국",
country=="Mexico"~"멕시코", country=="Canada"~"캐나다",
country=="Germany"~"독일", country=="Japan"~"일본",
country=="South Africa"~"남아공", country=="Italy"~"이탈리아",
country=="Spain"~"스페인", country=="United States"~"미국",
country=="France"~"프랑스")) |>
pivot_longer(!country, names_to="month", values_to="agree") |>
filter(country != "Total") |>
group_by(country) %>%
# 그래프상 수치 표현을 위한 위치 지정
mutate(increase = ifelse(agree == max(agree), TRUE, FALSE),
bump = ifelse(increase, agree + 2, agree - 2)) |>
ggplot(aes(x=agree, y=country, color=month)) +
geom_line(aes(group=country), size=1.75, color="#e6e6e6", show.legend = FALSE) +
geom_point(size=2, show.legend = FALSE) +
# glue를 이용해 수치 뒤에 %를 삽입
geom_text(aes(label=glue("{agree}%"), x=bump), show.legend=FALSE) +
scale_color_manual(name=NULL,
breaks=c("august", "october"),
values=c("#727272", "#15607a")) +
scale_x_continuous(limits=c(50, 100),
breaks=seq(50, 100, by=5),
labels=glue("{seq(50, 100, 5)}%")) +
# 세로 여백을 확보
scale_y_discrete(expand=c(0, 1.5)) +
labs(x=NULL, y=NULL,
title="코로나 백신 접종이 시작되면 접종을 받겠다",
caption="<i>15개 국가 16-74세 사이 18,526명에 대한 온라인 조사</i><br>출처: Ipsos") +
theme(plot.title.position = "plot",
plot.title = element_text(face="bold", margin= margin(b=20), size=20),
plot.caption = element_markdown(hjust=0, color="darkgray"),
plot.caption.position = "plot",
panel.background = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_text(color="darkgray"),
panel.grid.major.x = element_line(color="gray", size=0.1),
panel.grid.major.y = element_line(color="gray", size=0.1, linetype="dotted")) +
# 적절한 위치에 '8월', '10월' 표시시
geom_richtext(x=79, y=14.7, label="<span style='color:#15607a'> 10월 </span>",
fill = NA, label.color = NA, size=3, show.legend = FALSE) +
geom_richtext(x=88, y=14.7, label="<span style='color:#727272'> 8월 </span>",
fill = NA, label.color = NA, size=3, show.legend = FALSE)
data %>%
# 나라 이름을 한글로 변환
mutate(country = case_when(country=="India"~"인도", country=="China"~"중국",
country=="South Korea"~"한국", country=="Barzil"~"브라질",
country=="Australia"~"호주", country=="United Kingdom"~"영국",
country=="Mexico"~"멕시코", country=="Canada"~"캐나다",
country=="Germany"~"독일", country=="Japan"~"일본",
country=="South Africa"~"남아공", country=="Italy"~"이탈리아",
country=="Spain"~"스페인", country=="United States"~"미국",
country=="France"~"프랑스")) |>
pivot_longer(!country, names_to="month", values_to="agree") |>
filter(country != "Total") |>
group_by(country) %>%
# 그래프상 수치 표현을 위한 위치 지정
mutate(increase = ifelse(agree == max(agree), TRUE, FALSE),
bump = ifelse(increase, agree + 2, agree - 2)) |>
ggplot(aes(x=agree, y=country, color=month)) +
geom_line(aes(group=country), size=1.75, color="#e6e6e6", show.legend = FALSE) +
geom_point(size=2, show.legend = FALSE) +
# glue를 이용해 수치 뒤에 %를 삽입
geom_text(aes(label=glue("{agree}%"), x=bump), show.legend=FALSE) +
scale_color_manual(name=NULL,
breaks=c("august", "october"),
values=c("#727272", "#15607a")) +
scale_x_continuous(limits=c(50, 100),
breaks=seq(50, 100, by=5),
labels=glue("{seq(50, 100, 5)}%")) +
# 세로 여백을 확보
scale_y_discrete(expand=c(0, 1.5)) +
labs(x=NULL, y=NULL,
title="코로나 백신 접종이 시작되면 접종을 받겠다",
caption="<i>15개 국가 16-74세 사이 18,526명에 대한 온라인 조사</i><br>출처: Ipsos") +
theme(plot.title.position = "plot",
plot.title = element_text(face="bold", margin= margin(b=20), size=20),
plot.caption = element_markdown(hjust=0, color="darkgray"),
plot.caption.position = "plot",
panel.background = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_text(color="darkgray"),
panel.grid.major.x = element_line(color="gray", size=0.1),
panel.grid.major.y = element_line(color="gray", size=0.1, linetype="dotted")) +
# 적절한 위치에 '8월', '10월' 표시시
geom_richtext(x=79, y=14.7, label="<span style='color:#15607a'> 10월 </span>",
fill = NA, label.color = NA, size=5, show.legend = FALSE) +
geom_richtext(x=88, y=14.7, label="<span style='color:#727272'> 8월 </span>",
fill = NA, label.color = NA, size=5, show.legend = FALSE)
data %>%
# 나라 이름을 한글로 변환
mutate(country = case_when(country=="India"~"인도", country=="China"~"중국",
country=="South Korea"~"한국", country=="Barzil"~"브라질",
country=="Australia"~"호주", country=="United Kingdom"~"영국",
country=="Mexico"~"멕시코", country=="Canada"~"캐나다",
country=="Germany"~"독일", country=="Japan"~"일본",
country=="South Africa"~"남아공", country=="Italy"~"이탈리아",
country=="Spain"~"스페인", country=="United States"~"미국",
country=="France"~"프랑스")) |>
pivot_longer(!country, names_to="month", values_to="agree") |>
filter(country != "Total") |>
group_by(country) %>%
# 그래프상 수치 표현을 위한 위치 지정
mutate(increase = ifelse(agree == max(agree), TRUE, FALSE),
bump = ifelse(increase, agree + 2, agree - 2)) |>
ggplot(aes(x=agree, y=country, color=month)) +
geom_line(aes(group=country), size=1.75, color="#e6e6e6", show.legend = FALSE) +
geom_point(size=2, show.legend = FALSE) +
# glue를 이용해 수치 뒤에 %를 삽입
geom_text(aes(label=glue("{agree}%"), x=bump), show.legend=FALSE) +
scale_color_manual(name=NULL,
breaks=c("august", "october"),
values=c("#727272", "#15607a")) +
scale_x_continuous(limits=c(50, 100),
breaks=seq(50, 100, by=5),
labels=glue("{seq(50, 100, 5)}%")) +
# 세로 여백을 확보
scale_y_discrete(expand=c(0, 1.5)) +
labs(x=NULL, y=NULL,
title="코로나 백신 접종이 시작되면 접종을 받겠다",
caption="<i>15개 국가 16-74세 사이 18,526명에 대한 온라인 조사</i><br>출처: Ipsos") +
theme(plot.title.position = "plot",
plot.title = element_text(face="bold", margin= margin(b=20), size=20),
plot.caption = element_markdown(hjust=0, color="darkgray"),
plot.caption.position = "plot",
panel.background = element_blank(),
axis.ticks = element_blank(),
axis.text.x = element_text(color="darkgray"),
panel.grid.major.x = element_line(color="gray", size=0.1),
panel.grid.major.y = element_line(color="gray", size=0.1, linetype="dotted")) +
# 적절한 위치에 '8월', '10월' 표시시
geom_richtext(x=79, y=14.7, label="<span style='color:#15607a'> 10월 </span>",
fill = NA, label.color = NA, size=4, show.legend = FALSE) +
geom_richtext(x=88, y=14.7, label="<span style='color:#727272'> 8월 </span>",
fill = NA, label.color = NA, size=4, show.legend = FALSE)
install.packages('ggthemes')
