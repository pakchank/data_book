summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY"))
projects |>
mutate(year = year(date_posted)) |>
group_by(school_state, year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY")) |>
ggplot() +
aes(x=year, y=avg_size) +
geom_line(aes(group=school_state)) +
geom_point()
projects |>
mutate(year = year(date_posted)) |>
group_by(school_state, year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY")) |>
ggplot() +
aes(x=year, y=avg_size) +
geom_line(aes(color=school_state)) +
geom_point()
projects |>
mutate(year = year(date_posted)) |>
group_by(school_state, year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY")) |>
ggplot() +
aes(x=year, y=avg_size, color=school_state) +
geom_line() +
geom_point()
projects |>
mutate(year = year(date_posted)) |>
group_by(school_state, year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY")) |>
ggplot() +
aes(x=year, y=avg_size, linetype=school_state, shape=school_state) +
geom_line() +
geom_point()
projects |>
mutate(year = year(date_posted)) |>
group_by(year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
ggplot() +
aes(x=year, y=avg_size) +
geom_line() +
geom_point()
projects |>
mutate(year = year(date_posted)) |>
group_by(school_state, year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY")) |>
ggplot() +
aes(x=year, y=avg_size, color=school_state) +
geom_line() +
geom_point()
projects |>
mutate(year = year(date_posted)) |>
group_by(school_state, year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY")) |>
ggplot() +
aes(x=year, y=avg_size, color=school_state) +
geom_line() +
geom_point() +
labs(x="연도", y="평균 목표액", color="주(State)")
projects |>
mutate(year = year(date_posted)) |>
group_by(school_state, year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY")) |>
ggplot() +
aes(x=year, y=avg_size, color=school_state) +
geom_line() +
geom_point() +
labs(x="연도", y="평균 목표액", color="주(State)") +
scale_x_continuous(labels=2002:2014)
projects |>
mutate(year = year(date_posted)) |>
group_by(school_state, year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY")) |>
ggplot() +
aes(x=year, y=avg_size, color=school_state) +
geom_line() +
geom_point() +
labs(x="연도", y="평균 목표액", color="주(State)") +
scale_x_continuous(breaks=2002:2014, labels=2002:2014)
projects |>
mutate(year = year(date_posted)) |>
group_by(school_state, year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY")) |>
ggplot() +
aes(x=year, y=avg_size, color=school_state) +
geom_line() +
geom_point() +
labs(x="연도", y="평균 목표액", color="주(State)") +
scale_x_continuous(breaks=2002:2014, labels=2002:2014) +
scale_y_continuous(breaks=seq(400, 1800, by=200), labels=seq(400, 1800, by=200))
projects |>
mutate(year = year(date_posted)) |>
group_by(school_state, year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY")) |>
ggplot() +
aes(x=year, y=avg_size, color=school_state) +
geom_line() +
geom_point() +
labs(x="연도", y="평균 목표액", color="주(State)") +
scale_x_continuous(breaks=2002:2014, labels=2002:2014) +
scale_y_continuous(breaks=seq(400, 1800, by=200), labels=seq(400, 1800, by=200)) +
theme(panel.background = element_rect(fill = "lightblue",
colour = "lightblue",
size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.5, linetype = 'solid',
colour = "white"),
panel.grid.minor = element_line(size = 0.25, linetype = 'solid',
colour = "white"))
projects |>
mutate(year = year(date_posted)) |>
group_by(school_state, year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY")) |>
ggplot() +
aes(x=year, y=avg_size, color=school_state) +
geom_line() +
geom_point() +
labs(x="연도", y="평균 목표액", color="주(State)") +
scale_x_continuous(breaks=2002:2014, labels=2002:2014) +
scale_y_continuous(breaks=seq(400, 1800, by=200), labels=seq(400, 1800, by=200)) +
theme(panel.background = element_rect(fill = "white",
colour = "white",
size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.5, linetype = 'solid',
colour = "grey"),
panel.grid.minor = element_line(size = 0.25, linetype = 'solid',
colour = "lightgrey"))
projects |>
mutate(year = year(date_posted)) |>
group_by(school_state, year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY")) |>
ggplot() +
aes(x=year, y=avg_size, color=school_state) +
geom_line() +
geom_point() +
labs(x="연도", y="평균 목표액", color="주(State)") +
scale_x_continuous(breaks=2002:2014, labels=2002:2014) +
scale_y_continuous(breaks=seq(400, 1800, by=200), labels=seq(400, 1800, by=200)) +
scale_color_discrete(labels=c("하와이", "뉴욕")) +
theme(panel.background = element_rect(fill = "white",
colour = "white",
size = 0.5, linetype = "solid"),
panel.grid.major = element_line(size = 0.5, linetype = 'solid',
colour = "grey"),
panel.grid.minor = element_line(size = 0.25, linetype = 'solid',
colour = "lightgrey"))
projects |>
mutate(year = year(date_posted)) |>
group_by(school_state, year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY")) |>
ggplot() +
aes(x=year, y=avg_size, color=school_state) +
geom_line() +
geom_point() +
labs(x="연도", y="평균 목표액", color="주(State)") +
scale_x_continuous(breaks=2002:2014, labels=2002:2014) +
scale_y_continuous(breaks=seq(400, 1800, by=200), labels=seq(400, 1800, by=200)) +
scale_color_discrete(labels=c("하와이", "뉴욕")) +
theme(panel.background = element_rect(fill = "white",
colour = "white"),
panel.grid.major = element_line(size = 0.5, linetype = 'solid',
colour = "grey"),
panel.grid.minor = element_line(size = 0.25, linetype = 'solid',
colour = "lightgrey"))
projects |>
mutate(year = year(date_posted)) |>
group_by(school_state, year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY")) |>
ggplot() +
aes(x=year, y=avg_size, color=school_state) +
geom_line() +
geom_point() +
labs(x="연도", y="평균 목표액", color="주(State)") +
scale_x_continuous(breaks=2002:2014, labels=2002:2014) +
scale_y_continuous(breaks=seq(400, 1800, by=200), labels=seq(400, 1800, by=200)) +
scale_color_discrete(labels=c("하와이", "뉴욕")) +
theme(panel.background = element_rect(fill = "white",
colour = "white"),
panel.grid.major = element_line(size = 0.5, linetype = 'dashed',
colour = "grey"),
panel.grid.minor = element_line(size = 0.25, linetype = 'dotted',
colour = "lightgrey"))
projects |>
mutate(year = year(date_posted)) |>
group_by(school_state, year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY")) |>
ggplot() +
aes(x=year, y=avg_size, color=school_state) +
geom_line() +
geom_point() +
labs(x="연도", y="평균 목표액", color="주(State)") +
scale_x_continuous(breaks=2002:2014, labels=2002:2014) +
scale_y_continuous(breaks=seq(400, 1800, by=200), labels=seq(400, 1800, by=200)) +
scale_color_discrete(labels=c("하와이", "뉴욕")) +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major = element_line(size = 0.5, linetype = 'dashed',
colour = "grey"),
panel.grid.minor = element_line(size = 0.25, linetype = 'dotted',
colour = "lightgrey"))
projects |>
mutate(year = year(date_posted)) |>
group_by(school_state, year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY")) |>
ggplot() +
aes(x=year, y=avg_size, color=school_state) +
geom_line() +
geom_point() +
labs(x="연도", y="평균 목표액", color="주(State)") +
scale_x_continuous(breaks=2002:2014, labels=2002:2014) +
scale_y_continuous(breaks=seq(400, 1800, by=200), labels=seq(400, 1800, by=200)) +
scale_color_discrete(labels=c("하와이", "뉴욕")) +
theme_classic()
install.packages("ggthems")
projects |>
mutate(year = year(date_posted)) |>
group_by(school_state, year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY")) |>
ggplot() +
aes(x=year, y=avg_size, color=school_state) +
geom_line() +
geom_point() +
labs(x="연도", y="평균 목표액", color="주(State)") +
scale_x_continuous(breaks=2002:2014, labels=2002:2014) +
scale_y_continuous(breaks=seq(400, 1800, by=200), labels=seq(400, 1800, by=200)) +
scale_color_discrete(labels=c("하와이", "뉴욕")) +
theme_economist()
library(ggthems)
library(ggthemes)
install.packages("ggthemes")
library(ggthemes)
projects |>
mutate(year = year(date_posted)) |>
group_by(school_state, year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY")) |>
ggplot() +
aes(x=year, y=avg_size, color=school_state) +
geom_line() +
geom_point() +
labs(x="연도", y="평균 목표액", color="주(State)") +
scale_x_continuous(breaks=2002:2014, labels=2002:2014) +
scale_y_continuous(breaks=seq(400, 1800, by=200), labels=seq(400, 1800, by=200)) +
scale_color_discrete(labels=c("하와이", "뉴욕")) +
theme_economist()
projects |>
mutate(year = year(date_posted)) |>
group_by(school_state, year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY")) |>
ggplot() +
aes(x=year, y=avg_size, color=school_state) +
geom_line() +
geom_point() +
labs(x="연도", y="평균 목표액", color="주(State)") +
scale_x_continuous(breaks=2002:2014, labels=2002:2014) +
scale_y_continuous(breaks=seq(400, 1800, by=200), labels=seq(400, 1800, by=200)) +
scale_color_discrete(labels=c("하와이", "뉴욕")) +
+ theme_wsj()+ scale_colour_wsj("colors6")
projects |>
mutate(year = year(date_posted)) |>
group_by(school_state, year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY")) |>
ggplot() +
aes(x=year, y=avg_size, color=school_state) +
geom_line() +
geom_point() +
labs(x="연도", y="평균 목표액", color="주(State)") +
scale_x_continuous(breaks=2002:2014, labels=2002:2014) +
scale_y_continuous(breaks=seq(400, 1800, by=200), labels=seq(400, 1800, by=200)) +
scale_color_discrete(labels=c("하와이", "뉴욕")) +
theme_wsj() +
scale_colour_wsj("colors6")
projects |>
mutate(year = year(date_posted)) |>
group_by(school_state, year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY")) |>
ggplot() +
aes(x=year, y=avg_size, color=school_state) +
geom_line() +
geom_point() +
labs(x="연도", y="평균 목표액", color="주(State)") +
scale_x_continuous(breaks=2002:2014, labels=2002:2014) +
scale_y_continuous(breaks=seq(400, 1800, by=200), labels=seq(400, 1800, by=200)) +
scale_color_discrete(labels=c("하와이", "뉴욕")) +
theme_economist() +
scale_colour_economist(")
projects |>
mutate(year = year(date_posted)) |>
group_by(school_state, year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY")) |>
ggplot() +
aes(x=year, y=avg_size, color=school_state) +
geom_line() +
geom_point() +
labs(x="연도", y="평균 목표액", color="주(State)") +
scale_x_continuous(breaks=2002:2014, labels=2002:2014) +
scale_y_continuous(breaks=seq(400, 1800, by=200), labels=seq(400, 1800, by=200)) +
scale_color_discrete(labels=c("하와이", "뉴욕")) +
theme_economist() +
scale_colour_economist()
projects |>
mutate(year = year(date_posted)) |>
group_by(school_state, year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY")) |>
ggplot() +
aes(x=year, y=avg_size, color=school_state) +
geom_line() +
geom_point() +
labs(x="연도", y="평균 목표액", color="주(State)") +
scale_x_continuous(breaks=2002:2014, labels=2002:2014) +
scale_y_continuous(breaks=seq(400, 1800, by=200), labels=seq(400, 1800, by=200)) +
scale_colour_economist()
scale_color_discrete(labels=c("하와이", "뉴욕")) +
theme_economist() +
projects |>
mutate(year = year(date_posted)) |>
group_by(school_state, year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY")) |>
ggplot() +
aes(x=year, y=avg_size, color=school_state) +
geom_line() +
geom_point() +
labs(x="연도", y="평균 목표액", color="주(State)") +
scale_x_continuous(breaks=2002:2014, labels=2002:2014) +
scale_y_continuous(breaks=seq(400, 1800, by=200), labels=seq(400, 1800, by=200)) +
scale_colour_economist() +
scale_color_discrete(labels=c("하와이", "뉴욕")) +
theme_economist()
projects |>
mutate(year = year(date_posted)) |>
group_by(school_state, year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY")) |>
ggplot() +
aes(x=year, y=avg_size, color=school_state) +
geom_line() +
geom_point() +
labs(x="연도", y="평균 목표액", color="주(State)") +
scale_colour_economist() +
scale_color_discrete(labels=c("하와이", "뉴욕")) +
theme_economist()
projects |>
mutate(year = year(date_posted)) |>
group_by(school_state, year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY")) |>
ggplot() +
aes(x=year, y=avg_size, color=school_state) +
geom_line() +
geom_point() +
labs(x="연도", y="평균 목표액", color="주(State)") +
scale_colour_economist(labels=c("하와이", "뉴욕")) +
theme_economist()
projects |>
mutate(year = year(date_posted)) |>
group_by(school_state, year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY")) |>
ggplot() +
aes(x=year, y=avg_size, color=school_state) +
geom_line() +
geom_point() +
labs(x="연도", y="평균 목표액", color="주(State)") +
scale_colour_economist(labels=c("하와이", "뉴욕")) +
theme_economist() +
ggtitle("donorschoose.org 연도별 평균 목표액")
projects |>
mutate(year = year(date_posted)) |>
group_by(school_state, year) |>
summarise(avg_size = mean(total_price_excluding_optional_support)) |>
filter(school_state %in% c("HI", "NY")) |>
ggplot() +
aes(x=year, y=avg_size, color=school_state) +
geom_line() +
geom_point() +
labs(x="연도", y="평균 목표액", color="주(State)") +
scale_x_continuous(breaks=2002:2014, labels=2002:2014) +
scale_colour_economist(labels=c("하와이", "뉴욕")) +
theme_economist() +
ggtitle("donorschoose.org 연도별 평균 목표액액")
library(httr)
library(tidyverse)
library(ggtext)
library(glue)
Sys.setlocale("LC_ALL","Korean")
data <- read_csv("data/august_october_2020.csv")
data <- read_csv("data/august_october_2020.csv")
View(data)
data <- read_csv("data/august_october_2020.csv")
data
data <- data |>
rename(국가 = X.1, 8월 = `Total Agree - August 2020`,
data <- data |>
rename(country) = X.1, august = `Total Agree - August 2020`,
data <- data |>
rename(country = X.1, august = `Total Agree - August 2020`,
october = `Total Agree - October 2020`)
View(data)
View(data)
data |>
pivot_longer(names_to="month", values_to="agree") |>
ggplot() +
aes(x=month, y=agree) +
geom_point() +
geom_line(group=country)
data |>
pivot_longer(!country, names_to="month", values_to="agree") |>
ggplot() +
aes(x=month, y=agree) +
geom_point() +
geom_line(group=country)
View(data)
names(data)
data |>
pivot_longer(!country, names_to="month", values_to="agree")
data |>
pivot_longer(!country, names_to="month", values_to="agree") |>
ggplot() +
aes(x=month, y=agree) +
geom_point() +
geom_line(aes(group=country))
View(data)
data %>%
pivot_longer(!country, names_to="month", values_to="agree") |>
filter(country != "Total") |>
mutate(highlight = ifelse(country=="South Korea", TRUE, FALSE)) |>
ggplot(aes(x=month, y=agree, color=highlight)) +
geom_point(show.legend=FALSE) +
geom_line(aes(group=country, size=highlight), show.legend = FALSE) +
coord_fixed(ratio=0.04) +
labs(x="",
y="백신 투약 의사 비율",
title="<span style='color: blue'>한국</span>의 백신 투약 의사는<br>오히려 상승") +
scale_color_manual(breaks=c(TRUE, FALSE),
values=c("blue", "grey")) +
scale_size_manual(breaks=c(TRUE, FALSE),
values=c(1, 0.5)) +
scale_x_discrete(expand=c(0,0.1)) +
theme(text = element_text(color="grey"),
panel.background = element_rect(fill="white"),
axis.title.y = element_text(size=15),
axis.text = element_text(color="grey"),
plot.title = element_markdown(),
plot.title.position="plot")
data %>%
pivot_longer(!country, names_to="month", values_to="agree") |>
filter(country != "Total") |>
mutate(highlight = ifelse(country=="South Korea", TRUE, FALSE)) |>
ggplot(aes(x=month, y=agree, color=highlight)) +
geom_point(show.legend=FALSE) +
geom_line(aes(group=country, size=highlight), show.legend = FALSE) +
coord_fixed(ratio=0.04) +
labs(x="",
y="백신 투약 의사 비율",
title="<span style='color: blue'>한국</span>의 백신 투약 의사는<br>오히려 상승") +
scale_x_discrete(breaks=c("august", "october"),
labels=c("8월", "10월")) +
scale_color_manual(breaks=c(TRUE, FALSE),
values=c("blue", "grey")) +
scale_size_manual(breaks=c(TRUE, FALSE),
values=c(1, 0.5)) +
scale_x_discrete(expand=c(0,0.1)) +
theme(text = element_text(color="grey"),
panel.background = element_rect(fill="white"),
axis.title.y = element_text(size=15),
axis.text = element_text(color="grey"),
plot.title = element_markdown(),
plot.title.position="plot")
data %>%
pivot_longer(!country, names_to="month", values_to="agree") |>
filter(country != "Total") |>
mutate(highlight = ifelse(country=="South Korea", TRUE, FALSE)) |>
ggplot(aes(x=month, y=agree, color=highlight)) +
geom_point(show.legend=FALSE) +
geom_line(aes(group=country, size=highlight), show.legend = FALSE) +
coord_fixed(ratio=0.04) +
labs(x="",
y="백신 투약 의사 비율",
title="<span style='color: blue'>한국</span>의 백신 투약 의사는<br>오히려 상승") +
scale_color_manual(breaks=c(TRUE, FALSE),
values=c("blue", "grey")) +
scale_size_manual(breaks=c(TRUE, FALSE),
values=c(1, 0.5)) +
scale_x_discrete(expand=c(0,0.1), breaks=c("august", "october"),
labels=c("8월", "10월")) +
theme(text = element_text(color="grey"),
panel.background = element_rect(fill="white"),
axis.title.y = element_text(size=15),
axis.text = element_text(color="grey"),
plot.title = element_markdown(),
plot.title.position="plot")
